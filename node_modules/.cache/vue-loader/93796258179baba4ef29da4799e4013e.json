{"remainingRequest":"/Users/LXIN/Desktop/vue-sell-cube/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/LXIN/Desktop/vue-sell-cube/src/components/shop-cart/shop-cart.vue?vue&type=style&index=0&id=36d1a1bf&lang=stylus&rel=stylesheet%2Fstylus&scoped=true&","dependencies":[{"path":"/Users/LXIN/Desktop/vue-sell-cube/src/components/shop-cart/shop-cart.vue","mtime":1612219522546},{"path":"/Users/LXIN/Desktop/vue-sell-cube/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/LXIN/Desktop/vue-sell-cube/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/LXIN/Desktop/vue-sell-cube/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/LXIN/Desktop/vue-sell-cube/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/LXIN/Desktop/vue-sell-cube/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/LXIN/Desktop/vue-sell-cube/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCkBpbXBvcnQgIn5jb21tb24vc3R5bHVzL21peGluIgpAaW1wb3J0ICJ+Y29tbW9uL3N0eWx1cy92YXJpYWJsZSIKCi5zaG9wY2FydAogIGhlaWdodCAxMDAlCiAgLmNvbnRlbnQKICAgIGRpc3BsYXkgZmxleAogICAgYmFja2dyb3VuZCAkY29sb3ItYmFja2dyb3VuZAogICAgZm9udC1zaXplIDAKICAgIGNvbG9yICRjb2xvci1saWdodC1ncmV5CiAgICAuY29udGVudC1sZWZ0CiAgICAgIGZsZXggMQogICAgICAubG9nby13cmFwcGVyCiAgICAgICAgZGlzcGxheSBpbmxpbmUtYmxvY2sKICAgICAgICB2ZXJ0aWNhbC1hbGlnbiB0b3AKICAgICAgICBwb3NpdGlvbiByZWxhdGl2ZQogICAgICAgIHRvcCAtMTBweAogICAgICAgIG1hcmdpbiAwIDEycHgKICAgICAgICBwYWRkaW5nIDZweAogICAgICAgIHdpZHRoIDU2cHgKICAgICAgICBoZWlnaHQgNTZweAogICAgICAgIGJveC1zaXppbmcgYm9yZGVyLWJveAogICAgICAgIGJvcmRlci1yYWRpdXMgNTAlCiAgICAgICAgYmFja2dyb3VuZCAkY29sb3ItYmFja2dyb3VuZAogICAgICAgIC5sb2dvCiAgICAgICAgICB3aWR0aCAxMDAlCiAgICAgICAgICBoZWlnaHQgMTAwJQogICAgICAgICAgYm9yZGVyLXJhZGl1cyA1MCUKICAgICAgICAgIHRleHQtYWxpZ24gY2VudGVyCiAgICAgICAgICBiYWNrZ3JvdW5kICRjb2xvci1kYXJrLWdyZXkKICAgICAgICAgICYuaGlnaGxpZ2h0CiAgICAgICAgICAgIGJhY2tncm91bmQgJGNvbG9yLWJsdWUKICAgICAgICAgIC5pY29uLXNob3BwaW5nX2NhcnQKICAgICAgICAgICAgbGluZS1oZWlnaHQgNDRweAogICAgICAgICAgICBmb250LXNpemUgJGZvbnRzaXplLWxhcmdlLXh4eAogICAgICAgICAgICBjb2xvciAkY29sb3ItbGlnaHQtZ3JleQogICAgICAgICAgICAmLmhpZ2hsaWdodAogICAgICAgICAgICAgIGNvbG9yICRjb2xvci13aGl0ZQogICAgICAgIC5udW0KICAgICAgICAgIHBvc2l0aW9uIGFic29sdXRlCiAgICAgICAgICB0b3AgMAogICAgICAgICAgcmlnaHQgMAogICAgICAucHJpY2UKICAgICAgICBkaXNwbGF5IGlubGluZS1ibG9jawogICAgICAgIHZlcnRpY2FsLWFsaWduIHRvcAogICAgICAgIG1hcmdpbi10b3AgMTJweAogICAgICAgIGxpbmUtaGVpZ2h0IDI0cHgKICAgICAgICBwYWRkaW5nLXJpZ2h0IDEycHgKICAgICAgICBib3gtc2l6aW5nIGJvcmRlci1ib3gKICAgICAgICBib3JkZXItcmlnaHQgMXB4IHNvbGlkIHJnYmEoMjU1LCAyNTUsIDI1NSwgMC4xKQogICAgICAgIGZvbnQtd2VpZ2h0IDcwMAogICAgICAgIGZvbnQtc2l6ZSAkZm9udHNpemUtbGFyZ2UKICAgICAgICAmLmhpZ2hsaWdodAogICAgICAgICAgY29sb3I6ICRjb2xvci13aGl0ZQogICAgICAuZGVzYwogICAgICAgIGRpc3BsYXkgaW5saW5lLWJsb2NrCiAgICAgICAgdmVydGljYWwtYWxpZ24gdG9wCiAgICAgICAgbWFyZ2luIDEycHggMCAwIDEycHgKICAgICAgICBsaW5lLWhlaWdodCAyNHB4CiAgICAgICAgZm9udC1zaXplICRmb250c2l6ZS1zbWFsbC1zCiAgICAuY29udGVudC1yaWdodAogICAgICBmbGV4IDAgMCAxMDVweAogICAgICB3aWR0aCAxMDVweAogICAgICAucGF5CiAgICAgICAgaGVpZ2h0IDQ4cHgKICAgICAgICBsaW5lLWhlaWdodCA0OHB4CiAgICAgICAgdGV4dC1hbGlnbiBjZW50ZXIKICAgICAgICBmb250LXdlaWdodCA3MDAKICAgICAgICBmb250LXNpemUgJGZvbnRzaXplLXNtYWxsCiAgICAgICAgJi5ub3QtZW5vdWdoCiAgICAgICAgICBiYWNrZ3JvdW5kICRjb2xvci1kYXJrLWdyZXkKICAgICAgICAmLmVub3VnaAogICAgICAgICAgYmFja2dyb3VuZCAkY29sb3ItZ3JlZW4KICAgICAgICAgIGNvbG9yICRjb2xvci13aGl0ZQogIC5iYWxsLWNvbnRhaW5lcgogICAgLmJhbGwKICAgICAgcG9zaXRpb24gZml4ZWQKICAgICAgbGVmdCAzMnB4CiAgICAgIGJvdHRvbSAyMnB4CiAgICAgIHotaW5kZXggMjAwCiAgICAgIHRyYW5zaXRpb24gYWxsIDAuNHMgY3ViaWMtYmV6aWVyKDAuNDksIC0wLjI5LCAwLjc1LCAwLjQxKQogICAgICAuaW5uZXIKICAgICAgICB3aWR0aCAxNnB4CiAgICAgICAgaGVpZ2h0IDE2cHgKICAgICAgICBib3JkZXItcmFkaXVzIDUwJQogICAgICAgIGJhY2tncm91bmQgJGNvbG9yLWJsdWUKICAgICAgICB0cmFuc2l0aW9uIGFsbCAwLjRzIGxpbmVhcgo="},{"version":3,"sources":["shop-cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6PA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"shop-cart.vue","sourceRoot":"src/components/shop-cart","sourcesContent":["<template>\n  <div>\n    <div class=\"shopcart\">\n<!--      toggleList: 列表展开和收起-->\n      <div class=\"content\" @click=\"toggleList\">\n        <div class=\"content-left\">\n          <div class=\"logo-wrapper\">\n            <div class=\"logo\" :class=\"{'highlight':totalCount>0}\">\n              <i class=\"icon-shopping_cart\" :class=\"{'hightlight':totalCount>0}\"></i>\n            </div>\n            <div class=\"num\" v-show=\"totalCount>0\">\n              <bubble :num=\"totalCount\"></bubble>\n            </div>\n          </div>\n          <div class=\"price\" :class=\"{'highlight':totalPrice>0}\">￥{{totalPrice}}</div>\n          <div class=\"desc\">另需配送费￥{{deliveryPrice}}元</div>\n        </div>\n        <div class=\"content-right\" @click=\"pay\">\n          <div class=\"pay\" :class=\"payClass\">{{payDesc}}</div>\n        </div>\n      </div>\n      <div class=\"ball-container\">\n        <div v-for=\"(ball,index) in balls\" :key=\"index\">\n<!--          Vue 提供了 transition 的封装组件，某些情形中可以给任何元素和组件添加进入/离开过渡-->\n          <transition\n            @before-enter=\"beforeDrop\"\n            @enter=\"dropping\"\n            @after-enter=\"afterDrop\">\n            <div class=\"ball\" v-show=\"ball.show\">\n              <div class=\"inner inner-hook\"></div>\n            </div>\n          </transition>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script type=\"text/ecmascript-6\">\n  import Bubble from 'components/bubble/bubble'\n\n  const BALL_LEN = 10\n  const innerClsHook = 'inner-hook'\n\n  // 小球动画思路：\n  // 这里需要重绘的原因是：小球本身的位置在购物框中，为了实现从加号位置抛物线下落的效果，先把小球移动到了加号位置，\n  // 然后再按照一定缓动的动画移回购物车原始位置，因为小球整个动画是先从购物车移走再回购物车，整个过程是在一个 tick 内完成的，如果中途不强制重绘，浏览器会认为这个动画是无效的，就不会产生动画\n  // 如果一个元素同时做横向和纵向动画，那么叠加出来的效果是出不来抛物线的\n  // 假设购物车为篮子，里面已有10个小球，状态为不显示(show false)\n  function createBalls() {\n    let balls = []\n    for (let i = 0; i < BALL_LEN; i++) {\n      balls.push({ show: false })\n    }\n    return balls\n  }\n\n  export default {\n    name: 'shop-cart',\n    props: {\n      // 已选择的商品\n      selectFood: {\n        type: Array,\n        default() {\n          return []\n        }\n      },\n      deliveryPrice: {\n        type: Number,\n        default: 0\n      },\n      minPrice: {\n        type: Number,\n        default: 0\n      },\n      sticky: {\n        type: Boolean,\n        default: false\n      },\n      fold: {\n        type: Boolean,\n        default: true\n      }\n    },\n    data() {\n      return {\n        balls: createBalls(),\n        listFold: this.fold\n      }\n    },\n    created () {\n      this.dropBalls = []\n    },\n    computed: {\n      totalPrice() {\n        let total = 0\n        this.selectFood.forEach((food) => {\n          total += food.price * food.count\n        })\n        return total\n      },\n      totalCount() {\n        let count = 0\n        this.selectFood.forEach((food) => {\n          count += food.count\n        })\n        return count\n      },\n      payDesc() {\n        if (this.totalPrice === 0) {\n          return `￥${this.minPrice}元起送`\n        } else if (this.totalPrice < this.minPrice) {\n          let diff = this.minPrice - this.totalPrice\n          return `还差￥${diff}元起送`\n        } else {\n          return '去结算'\n        }\n      },\n      // 右侧\"去结算\"的按钮\n      payClass() {\n        if (!this.totalCount || this.totalPrice < this.minPrice) {\n          return 'not-enough'\n        } else {\n          return 'enough'\n        }\n      }\n    },\n    methods: {\n      // 列表收起 展开\n      // listFold 默认为false （不展开）\n      toggleList() {\n        if (this.listFold) {\n          if (!this.totalCount) {\n            return\n          }\n          this.listFold = false\n          this._showShopCartList()\n          this._showShopCartSticky()\n        } else {\n          this.listFold = true\n          this._hideShopCartList()\n        }\n      },\n      pay(e) {\n        if (this.totalPrice < this.minPrice) {\n          return\n        }\n        this.$createDialog({\n          title: '支付',\n          content: `您需要支付${this.totalPrice}元`\n        }).show()\n        e.stopPropagation()\n      },\n      // 接收参数el: 按钮位置\n      // drop 函数是从 balls 中找到第一个 show 为 false 的 ball，放到 dropBalls 里然后就 return 了，并没有显示所有球\n      drop(el) {\n        for (let i = 0; i < this.balls.length; i++) {\n          const ball = this.balls[i]\n          if (!ball.show) {\n            ball.show = true\n            ball.el = el\n            this.dropBalls.push(ball)\n            return\n          }\n        }\n      },\n      // 当前正在做动画的一个小球元素\n      // beforeDrop 的时候，el.style.display 为 none，需要显示的把它设置为 ''\n      beforeDrop(el) {\n        // 把这里理解成一个栈，后进先出的原则\n        const ball = this.dropBalls[this.dropBalls.length - 1]\n        const rect = ball.el.getBoundingClientRect()\n        const x = rect.left - 32\n        const y = -(window.innerHeight - rect.top - 22)\n        el.style.display = ''\n        // beforeDrop 函数里设置 transform 就是把小球从原本购物车的位置移动到按钮位置\n        el.style.transform = el.style.webkitTransform = `translate3d(0,${y}px,0)`\n        const inner = el.getElementsByClassName(innerClsHook)[0]\n        inner.style.transform = inner.style.webkitTransform = `translate3d(${x}px,0,0)`\n      },\n      // 执行完成后会执行done\n      dropping(el, done) {\n        // 页面重绘\n        this._reflow = document.body.offsetHeight\n        // 在 dropping 函数就是把小球从按钮位置移动到购物车位置\n        el.style.transform = el.style.webkitTransform = 'translate3d(0,0,0)'\n        const inner = el.getElementsByClassName(innerClsHook)[0]\n        inner.style.transform = inner.style.webkitTransform = 'translate3d(0,0,0)'\n        el.addEventListener('transitionend', done)\n      },\n      afterDrop(el) {\n        const ball = this.dropBalls.shift()\n        if (ball) {\n          ball.show = false\n          el.style.display = 'none'\n        }\n      },\n      _showShopCartList() {\n        this.shopCartComp = this.shopCartListComp || this.$createShopCartList({\n          $props: {\n            selectFood: 'selectFoods'\n          },\n          $events: {\n            leave: () => {\n              this._hideShopCartSticky()\n            },\n            hide: () => {\n              this.listFold = true\n            },\n            add: (el) => {\n              this.shopCartStickyComp.drop(el)\n            }\n          }\n        })\n        this.shopCartListComp.show()\n      },\n      _showShopCartSticky () {\n        this.shopCartStickyComp = this.shopCartStickyComp || this.$createShopCartSticky({\n          $props: {\n            selectFoods: 'selectFoods',\n            deliveryPrice: 'deliveryPrice',\n            minPrice: 'minPrice',\n            fold: 'listFold',\n            list: this.shopCartListComp\n          }\n        })\n        this.shopCartStickyComp.show()\n      },\n      _hideShopCartList() {\n        const list = this.sticky ? this.$parent.list : this.shopCartListComp\n        list.hide && list.hide()\n      },\n      _hideShopCartSticky() {\n        this.shopCartStickyComp.hide()\n      }\n    },\n    watch: {\n      fold(newVal) {\n        this.listFold = newVal\n      },\n      totalCount(count) {\n        if (!this.fold && count === 0) {\n          this._hideShopCartList()\n        }\n      }\n    },\n    components: {\n      Bubble\n    }\n  }\n</script>\n\n<style lang=\"stylus\" rel=\"stylesheet/stylus\" scoped>\n  @import \"~common/stylus/mixin\"\n  @import \"~common/stylus/variable\"\n\n  .shopcart\n    height 100%\n    .content\n      display flex\n      background $color-background\n      font-size 0\n      color $color-light-grey\n      .content-left\n        flex 1\n        .logo-wrapper\n          display inline-block\n          vertical-align top\n          position relative\n          top -10px\n          margin 0 12px\n          padding 6px\n          width 56px\n          height 56px\n          box-sizing border-box\n          border-radius 50%\n          background $color-background\n          .logo\n            width 100%\n            height 100%\n            border-radius 50%\n            text-align center\n            background $color-dark-grey\n            &.highlight\n              background $color-blue\n            .icon-shopping_cart\n              line-height 44px\n              font-size $fontsize-large-xxx\n              color $color-light-grey\n              &.highlight\n                color $color-white\n          .num\n            position absolute\n            top 0\n            right 0\n        .price\n          display inline-block\n          vertical-align top\n          margin-top 12px\n          line-height 24px\n          padding-right 12px\n          box-sizing border-box\n          border-right 1px solid rgba(255, 255, 255, 0.1)\n          font-weight 700\n          font-size $fontsize-large\n          &.highlight\n            color: $color-white\n        .desc\n          display inline-block\n          vertical-align top\n          margin 12px 0 0 12px\n          line-height 24px\n          font-size $fontsize-small-s\n      .content-right\n        flex 0 0 105px\n        width 105px\n        .pay\n          height 48px\n          line-height 48px\n          text-align center\n          font-weight 700\n          font-size $fontsize-small\n          &.not-enough\n            background $color-dark-grey\n          &.enough\n            background $color-green\n            color $color-white\n    .ball-container\n      .ball\n        position fixed\n        left 32px\n        bottom 22px\n        z-index 200\n        transition all 0.4s cubic-bezier(0.49, -0.29, 0.75, 0.41)\n        .inner\n          width 16px\n          height 16px\n          border-radius 50%\n          background $color-blue\n          transition all 0.4s linear\n</style>\n"]}]}